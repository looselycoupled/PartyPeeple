<div id="fb-root"></div>
<script src="http://connect.facebook.net/en_US/all.js"></script>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '<%= @app_id %>', // App ID
      channelURL : '//192.168.1.143/channel.html',
      status     : false, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      oauth      : true, // enable OAuth 2.0
      xfbml      : false  // parse XFBML
    });

    // Additional initialization code here
  };

  // Load the SDK Asynchronously
  // (function(d){
  //    var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
  //    js = d.createElement('script'); js.id = id; js.async = true;
  //    js.src = "//connect.facebook.net/en_US/all.js";
  //    d.getElementsByTagName('head')[0].appendChild(js);
  //  }(document));
   
   function login() {
     FB.login(function(response) {
        if (response.authResponse) {
          console.log('Welcome!');
          window.location.href = "/login";
        } else {
          console.log('User cancelled login or did not fully authorize.');
          // window.location.href = "/denied";
        }
      }, {scope: '<%= @app_perms %>'});
      return false;
   }
</script>

<a href="#" onclick="login();">Login with Facebook</a>